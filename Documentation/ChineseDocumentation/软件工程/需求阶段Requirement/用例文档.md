# 用例文档

| 参与者   | 用例                          | 功能描述                                           |
| -------- | ----------------------------- | -------------------------------------------------- |
| 普通用户 | [登入](#登入)                 | 用户使用已注册的用户名和密码登录系统。             |
|          | [登出](#登出)                 | 用户退出当前登录的系统账号。                       |
|          | [注册](#注册)                 | 用户在系统中注册新账号。                           |
|          | [忘记密码](#忘记密码)         | 用户重置已注册账号的密码。                         |
|          | [升级](#升级)                 | 用户提升自己的用户等级。                           |
|          | [查询](#查询)                 | 用户根据商品名称进行搜索，系统返回相应的商品列表。 |
|          | [收藏](#收藏)                 | 用户将感兴趣的商品添加到收藏列表中。               |
|          | [取消收藏商品](#取消收藏商品) | 用户将不感兴趣的商品从收藏列表删除                 |
|          | [查询收藏记录](#查询历史记录) | 用户查看已收藏的商品列表。                         |
|          | [订阅](#订阅)                 | 用户订阅感兴趣的商品，并在价格变动时收到通知。     |
|          | [取消订阅](#取消订阅)         | 用户取消订阅                                       |
|          | [更改个人信息](#更改个人信息) | 用户修改自己的个人信息，如用户名、密码等。         |
|          | [查询历史记录](#查询历史记录) | 用户查看自己的搜索历史记录和浏览历史记录。         |
|          | [接收通知](#接收通知)         | 用户接收通知                                       |



| 参与者 | 用例         | 功能描述                                   |
| ------ | ------------ | ------------------------------------------ |
| 管理员 | [登入](#登入)         | 管理员使用管理员账号和密码登录系统。       |
|        | [登出](#登出)         | 管理员退出当前登录的系统账号。             |
|        | [注册](#注册)         | 管理员无需注册，直接由系统管理员创建账号。 |
|        | [忘记密码](#忘记密码)     | 管理员无需重置密码，由系统管理员处理。     |
|        | [角色管理](#角色管理)     | 管理员管理系统中的用户角色信息。           |
|        | [商品爬取](#商品爬取)     | 管理员手动输入商品信息进行爬取。           |
|        | [更改爬取参数](#更改爬取参数) | 管理员修改爬虫的参数配置。                 |
|        | [ElasticSearch管理](#elasticsearch管理) | 管理员对ElasticSearch进行索引的增删改查操作。 |



| 参与者     | 用例                                  | 功能描述                                               |
| ---------- | ------------------------------------- | ------------------------------------------------------ |
| 信号发射器 | [爬取订阅商品](#爬取订阅商品)         | 信号发射器根据订阅表中的商品信息进行爬取，并通知用户。 |
|            | [爬取种类商品](#爬取种类商品)         | 信号发射器根据商品种类进行爬取                         |
|            | [发送商品通知](#发送商品通知)         | 发送商品价格通知给用户                                 |
|            | [索引最低价格商品](#索引最低价格商品) | 通过输入参数索引最低价格的商品                         |

---

### 登入

**参与者：** 普通用户 / 管理员

**用例名称：** 登入

**基本事件流：**
1. 用户或管理员打开系统登录界面。
2. 输入用户名和密码。
3. 点击登录按钮。
4. 系统验证用户名和密码的正确性。
5. 如果验证通过，系统允许用户或管理员进入系统；如果验证失败，系统显示错误提示信息。

**关系描述：** 无

**前置条件：** 
- 用户或管理员必须已经注册并拥有有效的用户名和密码。

**后置条件：** 
- 如果验证通过，用户或管理员成功登录系统；如果验证失败，则无法登录。

**限制：**
- 用户名和密码必须符合系统的要求。
- 登录页面必须可访问且可用。

**异常：**
- 如果输入的用户名或密码错误，系统将提示错误信息并要求重新输入。

---

### 登出

**参与者：** 普通用户 / 管理员

**用例名称：** 登出

**基本事件流：**
1. 用户或管理员在系统中点击退出按钮。
2. 系统提示确认退出。
3. 用户或管理员确认退出。
4. 系统登出用户或管理员账户，返回到登录页面。

**关系描述：** 无

**前置条件：** 
- 用户或管理员已经登录系统。

**后置条件：** 
- 用户或管理员账户已退出，系统返回到登录页面。

**限制：**
- 用户或管理员必须已经登录系统才能执行登出操作。

**异常：** 无

---

### 注册

**参与者：** 普通用户 / 管理员

**用例名称：** 注册

**基本事件流：**
1. 用户或管理员打开系统注册界面。
2. 输入注册信息，包括用户名、密码、邮箱等。
3. 点击注册按钮。
4. 系统验证输入信息的合法性。
5. 如果信息合法，系统保存用户或管理员信息并显示注册成功信息，否则显示错误提示信息。

**关系描述：** 该用例“包含”了验证，需要邮箱验证的支持

**前置条件：** 
- 用户或管理员需要访问注册页面并提供有效的注册信息。

**后置条件：** 
- 如果注册成功，新用户或管理员账户被成功创建；如果注册失败，系统不会创建新账户。

**限制：**
- 用户名、密码和邮箱等信息必须符合系统的要求。
- 注册页面必须可访问且可用。
- 邮箱以及用户名不能与数据库内冲突

**异常：**
- 如果输入的用户名或邮箱已经存在，系统将提示错误信息并要求重新输入。
- 如果输入的信息格式错误或不完整，系统将提示错误信息并要求重新输入。
---

### 忘记密码

**参与者：** 普通用户 / 管理员

**用例名称：** 忘记密码

**基本事件流：**
1. 用户或管理员在登录界面点击“忘记密码”链接。
2. 系统提示用户或管理员输入注册时的邮箱。
3. 用户或管理员输入邮箱验证码。
4. 用户或管理员输入并设置新密码。
5. 系统保存新密码并提示密码重置成功。

**关系描述：** 该用例“包含”了验证，需要邮箱验证的支持

**前置条件：** 
- 用户或管理员需要访问登录页面并提供注册时使用的邮箱。

**后置条件：** 
- 如果密码重置成功，用户或管理员可以使用新密码登录系统；如果密码重置失败，系统将不会更改密码。

**限制：**
- 用户或管理员需要有访问注册邮箱的权限。
- 系统必须能够正常发送和接收邮件。

**异常：**
- 如果输入的邮箱不存在或错误，系统将提示错误信息并要求重新输入。
- 如果邮件发送失败或用户或管理员无法收到邮件，系统将提示错误信息并要求用户或管理员联系系统管理员进行密码重置。

---

### 升级

**参与者：** 普通用户

**用例名称：** 升级

**基本事件流：**
1. 用户登录系统。
2. 用户进入个人信息页面。
3. 用户查看当前用户等级。
4. 用户选择升级选项。
5. 系统验证用户的升级条件。
6. 如果验证通过，系统将用户等级提升；如果验证失败，系统显示错误信息。

**关系描述：** 无

**前置条件：** 
- 用户已登录系统。

**后置条件：** 
- 如果升级成功，用户的等级将提升；如果升级失败，用户的等级保持不变。

**限制：**
- 用户必须符合系统设定的升级条件才能进行升级操作。

**异常：**
- 如果用户已达到最高等级或其他升级条件不满足，系统将提示错误信息并阻止升级操作。

---

### 查询

**参与者：** 普通用户

**用例名称：** 查询

**基本事件流：**
1. 用户登录系统。
2. 用户进入商品查询页面。
3. 用户输入商品信息（如：商品名称、商品种类等等）。
4. 用户点击搜索按钮。
5. 系统根据用户输入的关键字在数据库中检索商品信息。
6. 系统显示匹配的商品列表给用户。

**关系描述：** 

**前置条件：** 
- 用户已登录系统。

**后置条件：** 
- 系统返回包含商品信息的搜索结果列表给用户。

**限制：**
- 查询结果受到系统数据库中商品信息的限制。
- 用户需要选择商品种类才能进行搜索。

**异常：**
- 如果输入的商品名称不存在或错误，系统将返回空结果。
- 如果系统出现异常，可能导致查询失败，需要重新尝试或联系系统管理员。

---

### 收藏

**参与者：** 普通用户

**用例名称：** 收藏

**基本事件流：**
1. 用户登录系统。
2. 用户浏览商品列表并选择感兴趣的商品。
3. 用户点击商品详情页面中的“收藏”按钮。
4. 系统将商品添加到用户的收藏列表中。

**关系描述：** 无

**前置条件：** 无

**后置条件：** 
- 商品成功添加到用户的收藏列表中。

**限制：** 无

**异常：**
- 如果系统出现异常，可能导致收藏失败。

---

### 取消收藏商品

**参与者：** 普通用户

**用例名称：** 取消收藏商品

**基本事件流：**
1. 用户登录系统。
2. 用户从收藏商品列表点击要删除的商品。
3. 用户点击按钮。
4. 系统将商品从用户收藏列表中删除。

**关系描述：** 无

**前置条件：** 无

**后置条件：** 
- 商品成功从收藏列表中删除。

**限制：** 无

**异常：**
- 如果系统出现异常，可能导致取消收藏失败。

---

### 查询收藏记录

**参与者：** 普通用户

**用例名称：** 查询收藏记录

**基本事件流：**
1. 用户登录系统。
2. 用户点击收藏菜单。
3. 系统显示用户的收藏列表。

**关系描述：** 无

**前置条件：** 
- 用户已登录系统。

**后置条件：** 
- 系统显示用户的收藏列表。

**限制：**
- 无

**异常：**
- 如果用户没有收藏记录，系统将显示空列表。

---

### 订阅

**参与者：** 普通用户

**用例名称：** 订阅

**基本事件流：**
1. 用户登录系统。
2. 用户通输入商品信息（如：商品类型，商品名称，商品参数）订阅商品。
4. 用户选择订阅方式（如邮件、短信等）并确认订阅。
5. 系统将用户订阅的商品添加到商品订阅列表中以及用户订阅表，并在商品价格变动时向用户发送通知。

**关系描述：** 

**前置条件：** 
- 用户已登录系统且有感兴趣的商品。

**后置条件：** 
- 用户成功订阅了商品并将其添加到订阅列表中。

**限制：**
- 用户的等级决定了订阅数量以及推送频率。

**异常：**
- 如果系统出现异常，可能导致订阅失败，需要重新尝试或联系系统管理员。

---

### 取消订阅

**参与者：** 普通用户

**用例名称：** 取消订阅

**基本事件流：**
1. 用户登录系统。
2. 用户再订阅列表里选择要取消的订阅进行点击
4. 用户并确认取消订阅。
5. 系统将用户订阅的商品，并删除用户订阅表里的内容，并检查商品订阅表里是否需要删除。

**关系描述：** 

**前置条件：** 
- 用户已登录系统且希望取消之前的订阅。

**后置条件：** 
- 用户成功取消订阅了商品并将其从订阅列表中删除。

**限制：**
- 用户必须有订阅过商品。

**异常：**
- 如果系统出现异常，可能导致取消订阅失败，需要重新尝试或联系系统管理员。

---

### 更改个人信息

**参与者：** 普通用户

**用例名称：** 更改个人信息

**基本事件流：**
1. 用户登录系统。
2. 用户点击个人信息菜单。
3. 用户修改个人信息并保存更改。

**关系描述：** 无

**前置条件：** 
- 用户已登录系统。

**后置条件：** 
- 用户个人信息被成功修改并保存。

**限制：**
- 用户需要具有足够的权限来执行修改个人信息操作。

**异常：**
- 如果输入的个人信息格式错误或不完整，系统将提示错误信息并要求重新输入。

---

### 查询历史记录

**参与者：** 普通用户

**用例名称：** 查询历史记录

**基本事件流：**
1. 用户登录系统。
2. 用户点击历史记录菜单。
3. 系统显示用户的搜索历史记录和浏览历史记录。

**关系描述：** 无

**前置条件：** 
- 用户已登录系统。

**后置条件：** 
- 系统显示用户的搜索历史记录和浏览历史记录。

**限制：**
- 用户需要具有足够的权限来执行查询历史记录操作。

**异常：**
- 如果用户没有搜索历史记录或浏览历史记录，系统将显示空列表。

---

### 接收通知

**参与者：** 普通用户

**用例名称：** 接收通知

**基本事件流：**
1. 用户选择接收通知类型（邮箱、推送等等）。
2. 用户再特定情况接收通知。

**关系描述：** 无

**前置条件：** 
- 用户已登录系统、并选择接收通知类型。

**后置条件：** 
- 系统通过特定方式发送通知。

**限制：**
- 用户需要具有足够的权限来执行设置通知类型。

**异常：**
- 如果用户没有设置通知类型，系统自动发送到邮箱。

---

### 角色管理

**参与者：** 管理员

**用例名称：** 角色管理

**基本事件流：**
1. 管理员登录系统。
2. 管理员进入角色管理页面。
3. 管理员浏览用户列表并选择要管理的用户。
4. 管理员对选定的用户进行角色分配或权限管理操作。
5. 系统保存管理员对用户角色或权限的修改。

**关系描述：** 无

**前置条件：** 
- 管理员已登录系统。

**后置条件：** 
- 用户的角色或权限被成功修改并保存。

**限制：**
- 管理员需要具有足够的权限来执行角色管理操作。

**异常：**
- 如果系统出现异常，可能导致角色或权限修改失败，需要重新尝试或联系系统管理员。

---

### 商品爬取

**参与者：** 管理员

**用例名称：** 商品爬取

**基本事件流：**
1. 管理员登录系统。
2. 管理员进入商品爬取页面。
3. 管理员输入要爬取的商品信息（如：商品名称、商品种类等）。
4. 管理员点击开始爬取按钮。
5. 系统开始爬取商品信息，并将爬取结果存储到系统数据库中。

**关系描述：** 无

**前置条件：** 
- 管理员已登录系统。

**后置条件：** 
- 商品信息被成功爬取并保存到系统数据库中。

**限制：**
- 管理员需要具有足够的权限来执行商品爬取操作。
- 输入必须符合商品信息规范

**异常：**
- 如果爬取过程中出现异常或失败，系统将提示错误信息并记录爬取日志。

---

### 更改爬取参数

**参与者：** 管理员

**用例名称：** 更改爬取参数

**基本事件流：**
1. 管理员登录系统。
2. 管理员进入爬虫参数配置页面。
3. 管理员修改爬虫的参数，如爬取频率、爬取范围等。
4. 管理员保存修改并确认。
5. 系统保存管理员的参数修改。

**关系描述：** 无

**前置条件：** 
- 管理员已登录系统。

**后置条件：** 
- 爬虫参数被成功修改并保存到Json文件里。

**限制：**
- 管理员需要具有足够的权限来执行爬虫参数配置操作。

**异常：**
- 如果输入的参数格式错误或不合法，系统将提示错误信息并要求重新输入。

---

### ElasticSearch管理

**参与者：** 管理员

**用例名称：** ElasticSearch管理

**基本事件流：**
1. 管理员登录系统。
2. 管理员进入ElasticSearch管理页面。
3. 管理员浏览ElasticSearch中的索引列表。
4. 管理员对索引进行增加、删除、修改等操作。
5. 系统保存管理员对ElasticSearch的管理操作。

**关系描述：** 无

**前置条件：** 
- 管理员已登录系统。

**后置条件：** 
- 索引管理操作被成功执行并保存。

**限制：**
- 管理员需要具有足够的权限来执行ElasticSearch管理操作。

**异常：**
- 如果系统出现异常，可能导致索引管理操作失败，需要重新尝试或联系系统管理员。

---

### 爬取订阅商品

**参与者：** 信号发射器

**用例名称：** 爬取订阅商品

**基本事件流：**
1. 信号发射器按照预定的时间间隔开始执行爬取任务。
2. 读取订阅表中的商品信息。
3. 根据订阅表中的商品信息开始爬取相应的商品数据。
4. 爬取完成后，系统将新的商品数据存储到数据库中。
5. 系统检查价格变动并向订阅用户发送通知。

**关系描述：** 该用例描“包含”了“爬取商品”用例，将爬取商品信息作为参数传给该用例。

**前置条件：** 
- 信号发射器按照预定的时间间隔开始执行爬取任务。

**后置条件：** 
- 商品数据被成功爬取并存储到系统数据库中。
- 订阅用户收到关于价格变动的通知。

**限制：**
- 信号发射器需要按照预定的时间间隔执行爬取任务。

**异常：**
- 如果爬取过程中出现异常或失败，系统将记录错误日志并尝试重新爬取或联系系统管理员。

---

### 爬取种类商品

**参与者：** 信号发射器

**用例名称：** 爬取种类商品

**基本事件流：**
1. 信号发射器按照预定的时间间隔开始执行爬取任务。
2. 读取系统中已定义的商品种类信息。
3. 信号发射器根据商品种类开始爬取相应的商品数据。
4. 爬取完成后，系统将新的商品数据存储到数据库中。

**关系描述：** 该用例描“包含”了“爬取商品”用例，将爬取商品信息作为参数传给该用例。

**前置条件：** 
- 信号发射器按照预定的时间间隔开始执行爬取任务。

**后置条件：** 
- 商品数据被成功爬取并存储到系统数据库中。

**限制：**
- 信号发射器需要按照预定的时间间隔执行爬取任务。

**异常：**
- 如果爬取过程中出现异常或失败，系统将记录错误日志并尝试重新爬取或联系系统管理员。

### 发送商品通知

**参与者：** 信号发射器

**用例名称：** 发送商品通知

**基本事件流：**
1. 信号发射器完成爬取订阅商品后。
2. 读取系统中订阅商品的用户。
3. 信号发射器根据用户等级以及订阅商品发送给用户价格变更。

**关系描述：** 该功能“扩展”至“爬取订阅商品”用例

**前置条件：** 
- 信号发射器接收到爬取订阅商品的调用后才进行操作。

**后置条件：** 
- 发送信息给订阅用户。

**限制：**
- 必须在订阅商品的价格变更后才发送信息给订阅用户。

**异常：**
- 如果发送过程中出现异常或失败，系统将记录错误日志并尝试重新爬取或联系系统管理员。

### 索引最低价格商品

**参与者：** 信号发射器

**用例名称：** 索引最低价格商品

**基本事件流：**
1. 信号发射器遍历用户订阅表并进行商品查询。
2. 对比用户订阅里的价格，若查询价格更低，会通知用户价格变更。
3. 写入数据库。

**关系描述：** 该功能“扩展” “发送商品通知”用例以及“包含””搜索商品“用例

**前置条件：** 
- 信号发射器按照预定的时间间隔开始执行爬取任务。

**后置条件：** 
- 发送信息给订阅用户。

**限制：**
- 信号发射器需要按照预定的时间间隔执行爬取任务。

**异常：**
- 如果发送过程中出现异常或失败，系统将记录错误日志并尝试重新爬取或联系系统管理员。
